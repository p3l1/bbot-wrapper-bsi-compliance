\documentclass{article}
\usepackage{geometry}
\geometry{a4paper, margin=1in}

\title{BSI Compliance Check}
\date{Durchgeführt am \VAR{timestamp}}

\begin{document}

    \section{General}\label{sec:general}
    \subsection{BBOT}\label{subsec:bbot}
    \begin{itemize}
    \BLOCK{for id in scan_ids}
        \item \VAR{id}
    \BLOCK{endfor}
    \end{itemize}

    \section{TLS}\label{sec:tls}

    \BLOCK{for e in tls_compliance_events}
        \subsection{Host: \VAR{e.get("host")}:\VAR{e.get("port")} - Erkannte Algorithmen}\label{subsec:tls-valid-\VAR{e.get("host").replace(".", "-")}}

        \subsubsection{Erkannte TLS Versionen}

        \begin{itemize}
        \BLOCK{for id in e.get("found_algorithms").get("PROTOCOLS")}
            \item \VAR{id}
        \BLOCK{endfor}
        \end{itemize}

        \BLOCK{for tls_protocol_version in e.get("found_algorithms").get("PROTOCOLS")}

            \subsubsection{Erkannte Cipher für \VAR{tls_protocol_version}}

            \begin{center}
            \begin{tabular}{ |c|c|c| }
            \hline
            Name & Richtlinie & Gültig bis\\
            \hline
            \BLOCK{for cipher in e.get("found_algorithms").get(tls_protocol_version.replace(" ", "_").replace(".", "_") + "_CIPHERS")[0]}
                \VAR{cipher.get("name").replace("_", "\_")} & TODO & \VAR{cipher.get("valid_until")} \\
            \BLOCK{endfor}
            \hline
            \end{tabular}
            \end{center}

        \BLOCK{endfor}

    \BLOCK{endfor}

    \section{SSH}\label{sec:ssh}

    \BLOCK{for e in ssh_compliance_events}
        \subsection{Host: \VAR{e.get("host")} - Erkannte Algorithmen}\label{subsec:ssh-valid-\VAR{e.get("host").replace(".", "-")}}

        \subsubsection{Key Exchange (KEX)}

        \begin{center}
        \begin{tabular}{ |c|c|c| }
        \hline
        Name & Richtlinie & Gültig bis \\
        \hline
        \BLOCK{for kex in e.get("found_algorithms").get("KEX")}
            \VAR{kex.get("name")} & TODO & \VAR{kex.get("valid_until", "-")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Server Host Key (SHK)}

        \begin{center}
        \begin{tabular}{ |c|c|c| }
        \hline
        Name & Richtlinie & Gültig bis \\
        \hline
        \BLOCK{for shk in e.get("found_algorithms").get("SERVER_HOST_KEY")}
            \VAR{shk.get("name")} & TODO & \VAR{shk.get("valid_until", "-")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Server Client Encryption (ESC)}

        \begin{center}
        \begin{tabular}{ |c|c|c| }
        \hline
        Name & Richtlinie & Gültig bis \\
        \hline
        \BLOCK{for esc in e.get("found_algorithms").get("ENCRYPTION_SERVER_TO_CLIENT")}
            \VAR{esc.get("name")} & TODO & \VAR{esc.get("valid_until", "-")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{MAC Server Client Encryption (MSC)}

        \begin{center}
        \begin{tabular}{ |c|c|c| }
        \hline
        Name & Richtlinie & Gültig bis \\
        \hline
        \BLOCK{for msc in e.get("found_algorithms").get("MAC_SERVER_TO_CLIENT")}
            \VAR{msc.get("name")} & TODO & \VAR{msc.get("valid_until", "-")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        % Invalid algorithms
        \subsection{Host: \VAR{e.get("host")} - Nicht konforme Algorithmen}\label{subsec:ssh-invalid-\VAR{e.get("host").replace(".", "-")}}
        \subsubsection{Key Exchange (KEX)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for kex in e.get("invalid_algorithms").get("KEX")}
            \VAR{kex.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Server Host Key (SHK)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for shk in e.get("invalid_algorithms").get("SERVER_HOST_KEY")}
            \VAR{shk.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Server Client Encryption (ESC)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for esc in e.get("invalid_algorithms").get("ENCRYPTION_SERVER_TO_CLIENT")}
            \VAR{esc.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{MAC Server Client Encryption (MSC)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for msc in e.get("invalid_algorithms").get("MAC_SERVER_TO_CLIENT")}
            \VAR{msc.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

    \BLOCK{endfor}

    % IPSEC BEGIN

    \section{IPSEC IKEv1}\label{sec:ipsec}

    \BLOCK{for e in ipsec_compliance_events}
        \subsection{Host: \VAR{e.get("host")}:\VAR{e.get("port")} - Erkannte/Invalide Algorithmen}\label{subsec:ipsec-invalid-\VAR{e.get("host").replace(".", "-")}}

        \subsubsection{Encryption (ENC)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for enc in e.get("invalid_algorithms").get("found_encr_algorithms")}
            \VAR{enc.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Integrity (INT)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for inte in e.get("invalid_algorithms").get("found_integ_algorithms")}
            \VAR{inte.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Authentication (AUT)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for auth in e.get("invalid_algorithms").get("found_auth_methods")}
            \VAR{auth.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

        \subsubsection{Diffie-Hellman Groups (DHG)}

        \begin{center}
        \begin{tabular}{ |c| }
        \hline
        Name \\
        \hline
        \BLOCK{for dhg in e.get("invalid_algorithms").get("found_dh_groups")}
            \VAR{dhg.get("name")} \\
        \BLOCK{endfor}
        \hline
        \end{tabular}
        \end{center}

    \BLOCK{endfor}

\end{document}
